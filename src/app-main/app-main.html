<link
    rel="import"
    href="../../bower_components/polymer/polymer.html">
<link
    rel="import"
    href="../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link
    rel="import"
    href="../../bower_components/paper-button/paper-button.html">
<link
    rel="import"
    href="../../bower_components/paper-card/paper-card.html">
<link
    rel="import"
    href="../../bower_components/paper-input/paper-input.html">
<link
    rel="import"
    href="../../bower_components/paper-styles/color.html">

<link
    rel="import"
    href="../sketch-canvas/sketch-canvas.html">

<dom-module id="app-main">

  <template>

    <style is="custom-style" include="iron-flex iron-flex-alignment">
      :host {
        font-family: 'Roboto', 'Noto', sans-serif;
        font-size: 36pt;
        @apply(--layout-vertical);
        @apply(--layout-center);
        --paper-input-container-label: {
          font-size: 20pt !important;
        };
        --paper-input-container-input: {
          font-size: 36pt !important;
        };
        width: 100%;
        height: 100%;
      }
      div > paper-input {
        margin: 0 10px 20px 10px;
      }
      paper-button.submit {
        color: white;
        background-color: var(--paper-green-800);
      }
      .fill {
        width: 100%;
        @apply(--layout-flex);
      }
      paper-card {
        @apply(--layout-vertical);
      }
      .card-content {
        @apply(--layout-flex-auto);
      }
      .card-actions {
        @apply(--layout-flex-none);
      }
    </style>

    <paper-card hidden$="[[ !_onPage(page, 1) ]]">

      <div class="card-content">

        <paper-input
            label="Your Name (First and Last)"
            value="{{ name }}"
        ></paper-input>

        <paper-input
            label="Date of Birth (mm/dd/yy)"
            value="{{ dob }}"
        ></paper-input>

        <paper-input
            label="What is today's date? (mm/dd/yy)"
            value="{{ today }}"
        ></paper-input>

      </div>

      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>

    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 2) ]]">

      <div class="card-content">
        <p>On the next to last question, write the following words in any order:</p>
        <ul>
          <li>House</li>
          <li>Tree</li>
          <li>Music</li>
        </ul>
      </div>

      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>

    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 3) ]]">
      <div class="card-content layout vertical">
        <img src="../../images/wreath.jpg" class="self-center">
        <label>Name the picture shown above</label>
        <paper-input value="{{ picture1 }}"></paper-input>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 4) ]]">
      <div class="card-content layout vertical">
        <img src="../../images/volcano.jpg" class="self-center">
        <label>Name the picture shown above</label>
        <paper-input value="{{ picture2 }}"></paper-input>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 5) ]]">
      <div class="card-content">

        <label>
          How are a watch and a ruler similar? Write down how they are alike. They both are... what?
        </label>
        <paper-input value="{{ question1 }}"></paper-input>

        <label>
          How many nickels are in 60 cents?
        </label>
        <paper-input value="{{ question2 }}"></paper-input>

        <label>
          You are buying $13.45 of groceries. How much change would you receive back from a $20 bill?
        </label>
        <paper-input value="{{ question3 }}"></paper-input>

      </div>

      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>

    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 6) ]]">
      <div class="card-content">
        <p>On the last question, write “I am done” on the blank line provided.</p>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 7) ]]" class="fill">
      <div class="card-content layout vertical">
        <label class="flex-none">Draw a picture of a clock with the time set to 3:40</label>
        <sketch-canvas class="flex-auto"></sketch-canvas>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 8) ]]">
      <div class="card-content">
        <label>Write down the names of 12 different animals</label>
        <div class="layout vertical">
          <div class="layout horizontal">
            <paper-input value="{{ animal1 }}"></paper-input>
            <paper-input value="{{ animal2 }}"></paper-input>
            <paper-input value="{{ animal3 }}"></paper-input>
            <paper-input value="{{ animal4 }}"></paper-input>
          </div>
          <div class="layout horizontal">
            <paper-input value="{{ animal5 }}"></paper-input>
            <paper-input value="{{ animal6 }}"></paper-input>
            <paper-input value="{{ animal7 }}"></paper-input>
            <paper-input value="{{ animal8 }}"></paper-input>
          </div>
          <div class="layout horizontal">
            <paper-input value="{{ animal9 }}"></paper-input>
            <paper-input value="{{ animal10 }}"></paper-input>
            <paper-input value="{{ animal11 }}"></paper-input>
            <paper-input value="{{ animal12 }}"></paper-input>
          </div>
        </div>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 9) ]]">
      <div class="card-content">
        <label>
          What were the three words you were told to remember?
        </label>
        <paper-input value="{{ words }}"></paper-input>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button on-tap="_nextPage">Next</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 10) ]]">
      <div class="card-content">
        <label>
          Have you finished?
        </label>
        <paper-input value="{{ finished }}"></paper-input>
      </div>
      <div class="card-actions layout horizontal end-justified">
        <paper-button class="submit" on-tap="_nextPage" raised>Submit</paper-button>
      </div>
    </paper-card>

    <paper-card hidden$="[[ !_onPage(page, 11) ]]">
      <div class="card-content">
        <p>Thank you, your score is {{ score }} / 27.</p>
      </div>
    </paper-card>
    
  </template>

  <script>
    Polymer({
      is: 'app-main',
      properties: {
        page: {
          type: Number,
          value: 1,
        },
        name: String,
        dob: String,
        today: String,
        picture1: String,
        picture2: String,
        question1: String,
        question2: String,
        question3: String,
        animal1: String,
        animal2: String,
        animal3: String,
        animal4: String,
        animal5: String,
        animal6: String,
        animal7: String,
        animal8: String,
        animal9: String,
        animal10: String,
        animal11: String,
        animal12: String,
        finished: String,
        words: String,
      },
      _onPage(onPage, wantPage) {
        return onPage == wantPage;
      },
      _nextPage() {
        this.page += 1;
        this.fire('pagechange', {
          page: this.page,
        });
        if (this.page === 11) {
          this._score();
        }
      },
      _score() {
        this.score = 0;

        const d = this.today.split('/');
        const today = new Date();
        const month = parseInt(d[0]);
        const day = parseInt(d[1]);
        const year = parseInt(d[2]);
        if (today.getDate() == day) {
          this.score += 1;
        }
        if (today.getMonth()+1 == month) {
          this.score += 1;
        }
        if (today.getFullYear() == year) {
          this.score += 1;
        }

        if (this.picture1.toLowerCase() == 'wreath') {
          this.score += 1;
        }

        if (this.picture2.toLowerCase() == 'volcano') {
          this.score += 1;
        }

        if (this.question1.toLowerCase().includes('measure')) {
          this.score += 1;
        }

        if (this.question2.toLowerCase().includes('12')) {
          this.score += 1;
        }

        if (this.question3.toLowerCase().includes('6')) {
          this.score += 1;
        }

        if (this.question3.toLowerCase().includes('55')) {
          this.score += 1;
        }

        if (this.question3.toLowerCase().includes('6.55')) {
          this.score += 1;
        }

        const animals = [
          this.animal1,
          this.animal2,
          this.animal2,
          this.animal3,
          this.animal4,
          this.animal5,
          this.animal6,
          this.animal7,
          this.animal8,
          this.animal9,
          this.animal10,
          this.animal11,
          this.animal12,
        ].filter((a) => a);

        this.score += animals.length;

        if (this.finished.toLowerCase().includes('done') ||
            this.finished.toLowerCase().includes('finished')) {
          this.score += 1;
        }

        if (this.finished.toLowerCase().includes('I am done')) {
          this.score += 1;
        }

        if (this.words.toLowerCase().includes('house')) {
          this.score += 1;
        }
        if (this.words.toLowerCase().includes('tree')) {
          this.score += 1;
        }
        if (this.words.toLowerCase().includes('music')) {
          this.score += 1;
        }
      }
    });
  </script>

</dom-module>